imports:
  - { resource: '@CoreBundle/Resources/config/services/legacy.yml' }
  - { resource: '@CoreBundle/Resources/config/services/asterisk.yml' }
  - { resource: '@CoreBundle/Resources/config/services/doctrine.yml' }
  - { resource: "@CoreBundle/Resources/config/services/path_resolvers.yml" }
  - { resource: "@CoreBundle/Resources/config/services/assemblers.yml" }
  - { resource: "@CoreBundle/Resources/config/services/domain.yml" }
  - { resource: "@CoreBundle/Resources/config/services/events.yml" }
  - { resource: "@CoreBundle/Resources/config/services/application.yml" }
  - { resource: '@CoreBundle/Resources/config/lifecycle.yml' }

services:
  _defaults:
    autowire: true
    autoconfigure: true
    public: false

  Ivoz\Core\Infrastructure\Application\DoctrineForeignKeyTransformer:
    arguments:
      - '@doctrine.orm.entity_manager'

  core.doctrine_foreign_key_transformer:
    '@Ivoz\Core\Infrastructure\Application\DoctrineForeignKeyTransformer'

  Ivoz\Core\Infrastructure\Application\DoctrineCollectionTransformer:
    arguments:
      - '@doctrine.orm.entity_manager'

  core.doctrine_collection_transformer:
    '@Ivoz\Core\Infrastructure\Application\DoctrineCollectionTransformer'

  Ivoz\Core\Application\Service\CreateEntityFromDTO:
    arguments:
      - '@core.doctrine_foreign_key_transformer'
      - '@core.doctrine_collection_transformer'
      - '@Ivoz\Core\Application\Service\Assembler\EntityAssembler'

  core.create_entity_from_dto:
    class: Ivoz\Core\Application\Service\CreateEntityFromDTO

  Ivoz\Core\Application\Service\UpdateEntityFromDTO:
    arguments:
      - '@core.doctrine_foreign_key_transformer'
      - '@core.doctrine_collection_transformer'
      - '@Ivoz\Core\Application\Service\Assembler\EntityAssembler'
    public: true

  core.update_entity_from_dto:
    class: Ivoz\Core\Application\Service\UpdateEntityFromDTO

  Ivoz\Core\Infrastructure\Domain\Service\DoctrineEntityPersister:
    public: true

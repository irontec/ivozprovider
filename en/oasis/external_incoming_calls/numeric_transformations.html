

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Numeric transformations &mdash; IvozProvider Oasis documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/banner.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="IvozProvider Oasis documentation" href="../index.html"/>
        <link rel="up" title="Receive external calls" href="index.html"/>
        <link rel="next" title="Configuring a Peering Contract" href="peering_contracts.html"/>
        <link rel="prev" title="Receive external calls" href="index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> IvozProvider
          

          
          </a>

          
            
            
              <div class="version">
                1.7
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Basic Concepts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro/index.html">Introduction to IvozProvider</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../architecture/index.html">Platform general architecture</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../operation_roles/index.html">Platform roles</a></li>
</ul>
<p class="caption"><span class="caption-text">Minimum Configuration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html">Initial Installation</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../internal_calls/index.html">Making internal calls</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Receive external calls</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Numeric transformations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#concept">Concept</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#incoming-transformations">Incoming transformations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#outgoing-transformations">Outgoing transformations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#national-provider-transformations">&#8216;National provider&#8217; transformations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#spanish-incoming-transformation">Spanish incoming transformation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#spanish-outgoing-transformation">Spanish outgoing transformation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="peering_contracts.html">Configuring a Peering Contract</a></li>
<li class="toctree-l2"><a class="reference internal" href="configure_ddi.html">Configuring an external DDI</a></li>
<li class="toctree-l2"><a class="reference internal" href="configure_ddi.html#configure-incoming-routes">Configure incoming routes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../external_outgoing_calls/index.html">Making external calls</a></li>
</ul>
<p class="caption"><span class="caption-text">Advanced Configuration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../pbx_features/index.html">PBX Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../retail/index.html">Retail Clients</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../billing_and_invoices/index.html">Billing and Invoices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../provisioning/index.html">Terminal provisioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faxing/index.html">Virtual Fax System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userportal/index.html">User Portal</a></li>
</ul>
<p class="caption"><span class="caption-text">Security and Maintenance</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../security/index.html">Security elements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../maintenance/index.html">Maintenance and troubleshooting</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">IvozProvider</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">Receive external calls</a> &raquo;</li>
      
    <li>Numeric transformations</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/external_incoming_calls/numeric_transformations.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="numeric-transformations">
<span id="id1"></span><h1>Numeric transformations<a class="headerlink" href="#numeric-transformations" title="Permalink to this headline">¶</a></h1>
<div class="section" id="concept">
<h2>Concept<a class="headerlink" href="#concept" title="Permalink to this headline">¶</a></h2>
<p><strong>IvozProvider</strong> is designed to provide service <strong>anywhere in the planet</strong>, not
only the original country where the platform is installed.</p>
<p>A very important contept to archive this goal is the numeric transformation,
that <strong>adapts the different number format systems of the countries of the world</strong>
defined in <a class="reference external" href="https://www.itu.int/rec/T-REC-E.164/es">E.164</a> <strong>to a neutral
format</strong>.</p>
<p>The section that allows the brand operator to configure all the <strong>numeric
transformations</strong> is:</p>
<img alt="../_images/numeric_transformations_section.png" class="align-center" src="../_images/numeric_transformations_section.png" />
<p>There are two different transformation scenarios:</p>
<div class="section" id="incoming-transformations">
<h3>Incoming transformations<a class="headerlink" href="#incoming-transformations" title="Permalink to this headline">¶</a></h3>
<p>When a new call is received in IvozProvider matching a provider that has been
configured for <em>peering</em>, we must adapt the numbers that make reference to:</p>
<ul class="simple">
<li>Origin of the call</li>
<li>Destination of the call</li>
</ul>
<p>Depending on the country of the provider, the international numbers will have
a format or another. In this case, the spanish provider will use, for example:</p>
<ul class="simple">
<li>00 + 33 + number belonging to France</li>
<li>It&#8217;s possible that the international numbers came without the 00 code.</li>
<li>It&#8217;s possible that, if the call comes from the same country that the provider,
the number comes without the calling code (911234567 insted of 00 + 34 +
911234567 for Spain).</li>
</ul>
<p>For an Ukranian provider, that doesn&#8217;t use the 00 as international code:</p>
<ul class="simple">
<li>It will use 810 + 33 + number belonging to France.</li>
<li>It&#8217;s possible that even part of the internation code (00 in most of the
countries of the world) the provider use specific codes as prefix.</li>
</ul>
<p>The goal of the incoming transformation is that, no matter what numeric system
the provider uses, the number will end in a general and common format.</p>
<div class="admonition important" id="e164">
<p class="first admonition-title">Important</p>
<p class="last">This common format is usually called E.164 and shows the numbers
without internation code, but with country calling code: i.e. 34911234567</p>
</div>
</div>
<div class="section" id="outgoing-transformations">
<h3>Outgoing transformations<a class="headerlink" href="#outgoing-transformations" title="Permalink to this headline">¶</a></h3>
<p>In the same whay the origin and destination must adaptat incoming numbers, it
will be required to adapt outgoing dialed numbers to properly work with each
of the providers that will route our call.</p>
<p>For example, for a number with spanish number system:</p>
<ul class="simple">
<li><em>Spanish provider</em>: Destination will come in E164 (34911234567) and for this
provider, we can remove the calling code (will understand it belongs to
its country), so the number sent to them will be 911234567.</li>
<li><em>French provider</em>: The destination will come in E164 (34911234567) and we must
add the international code for France, so the number sent to them will be
0034911234567.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To sum up, we aim to send the origin and destination in the format the
provider is expecting.</p>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Numeric transformation uses <a class="reference external" href="https://es.wikipedia.org/wiki/Expresi%C3%B3n_regular">simple regular expresions</a> to describe the
changes done to the numbers. You can find multiple tutorials on net with the
basic regular expression format.</p>
</div>
</div>
</div>
<div class="section" id="national-provider-transformations">
<h2>&#8216;National provider&#8217; transformations<a class="headerlink" href="#national-provider-transformations" title="Permalink to this headline">¶</a></h2>
<p>IvozProvider comes with an automatic transformation rules generator that fits
with most of the countries.</p>
<p>In order to create a new set of transformations for spanish provider:</p>
<img alt="../_images/numeric_transformations_auto.png" class="align-center" src="../_images/numeric_transformations_auto.png" />
<p>The rules that has been auto-created will transform the numbers for spanish
providers that follow this rules:</p>
<ul class="simple">
<li>A spanish number: Neither international nor calling code (34).</li>
<li>Not a spanish number: International code (00) and calling code (34).</li>
</ul>
<p>The numeric transformation <em>sets</em> must be assigned to <strong>Peering Contracts</strong>, as
shown in the following section. This <em>set</em> can be shared by multiple spanish
providers.</p>
<p>Let&#8217;s check this <em>set</em> to understand what transformation rule does:</p>
<img alt="../_images/numeric_transformations.png" src="../_images/numeric_transformations.png" />
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p class="last">The automatic rule generation will create 8 common rules based on
the given parameters. This rules can be edited later to match the provider
requirements.</p>
</div>
<div class="section" id="spanish-incoming-transformation">
<h3>Spanish incoming transformation<a class="headerlink" href="#spanish-incoming-transformation" title="Permalink to this headline">¶</a></h3>
<p>Displayed in blue in the previous image:</p>
<ul class="simple">
<li>Left called/destination</li>
<li>Right callee/origin</li>
</ul>
<p>The same rules will be applied for the origin and destination:</p>
<img alt="../_images/numeric_transformations2.png" src="../_images/numeric_transformations2.png" />
<ul>
<li><p class="first">The <strong>metric</strong> field will be used to order the rules (smaller first).</p>
<blockquote>
<div><ul class="simple">
<li>If a rule doesnt <em>match</em>, the next rule is evaluated.</li>
<li>If a rule <em>matches</em>, no more rules are evaluated.</li>
<li>If no rule <em>matches</em>, no change is applied.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">The <strong>Search</strong> field is evaluated agains the number (depending of the
tranformation type it will be destination or origin).</p>
<blockquote>
<div><ul class="simple">
<li>Metric 1: Starting with (^) 00 or &#8216;+&#8217;, followed by a digit between 1 and 9
and only digits between 0 and 9 until the end ($).</li>
<li>Metric 2: Starting with a digit bewteen 1 and 9, followed by eight digits
between 0 and 9 until the end($).</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">The <strong>Replace</strong> field will use the capture groups that matched the Search
field (displayed between brackets, 1 for the first one, 2 for the second
one, and so on) to determine how the number will end.</p>
<blockquote>
<div><ul class="simple">
<li>Metric 1: The number will be converted just to the second capture (2)</li>
<li>Metric 2: The number will be converted to the first capture with 34 prefix</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Or <em>in other words</em>:</p>
<blockquote>
<div><ul class="simple">
<li>Metric 1: Strip the international code (00 or &#8216;+&#8217;)</li>
<li>Metric 2: Add 34 to spanish numbers that comes without calling code.</li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="spanish-outgoing-transformation">
<h3>Spanish outgoing transformation<a class="headerlink" href="#spanish-outgoing-transformation" title="Permalink to this headline">¶</a></h3>
<img alt="../_images/numeric_transformations3.png" src="../_images/numeric_transformations3.png" />
<p>Following the same logic, this 2 rules make the change of the outgoig external
destination numbers:</p>
<ul class="simple">
<li>Metric 1: If the number starts with 34 prefix, remove it. This converts
E.164 spanish numbers to national format.</li>
<li>Metric 2: If the number doesn&#8217;t start with 34 prefix, add 00. This converts
E.164 international numbers to spanish international numbers.</li>
</ul>
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p class="last"><strong>To sum up</strong>: numeric tranformation can adapt origin and
destination numbers to E.164 for the platform, and to providers expected
formats, based on regular expresions and metric that can be grouped in <em>sets</em>
to be shared between multiple <strong>Peering Contracts</strong>.</p>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="peering_contracts.html" class="btn btn-neutral float-right" title="Configuring a Peering Contract" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Receive external calls" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2017, Irontec.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Other Versions</span>
        v: oasis
        <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Branches</dt>
            <dd><a href="../../artemis/index.html">artemis</a></dd>
            <dd><a href="../../halliday/index.html">halliday</a></dd>
            <dd><a href="../../main/index.html">main</a></dd>
            <dd><a href="numeric_transformations.html">oasis</a></dd>
            <dd><a href="../../tempest/index.html">tempest</a></dd>
        </dl>
    </div>
</div>


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'Oasis',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>
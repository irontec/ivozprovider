<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">


<html xmlns="http://www.w3.org/1999/xhtml" lang="es">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Programadores de CSV de llamadas</title>
    
    <link rel="stylesheet" href="../../../_static/epub.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/banner.css" type="text/css" /> 
  </head>
  <body role="document">

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.xhtml" title="Índice General"
             accesskey="I">índice</a></li>
        <li class="right" >
          <a href="../settings/index.xhtml" title="Configuraciones"
             accesskey="N">siguiente</a> |</li>
        <li class="right" >
          <a href="external_calls.xhtml" title="Llamadas externas"
             accesskey="P">anterior</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.xhtml">documentación de IvozProvider - tempest</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.xhtml" >Configuración de Marca</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.xhtml" accesskey="U">Llamadas</a> &#187;</li> 
      </ul>
    </div>

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <div class="section" id="call-csv-schedulers">
<span id="id1"></span><h1>Programadores de CSV de llamadas</h1>
<p>Esta sección permite programar informes CSV periódicos automáticos para los operadores de marca.</p>
<div class="admonition note">
<p class="first admonition-title">Nota</p>
<p class="last">Esta sección es casi idéntica a <a class="reference internal" href="../invoicing/invoice_schedulers.xhtml#invoice-schedulers"><span class="std std-ref">Programadores de facturas</span></a> excepto por los campos que no se aplican a los CSV (secuencia de número de factura, tasa de impuesto...)</p>
</div>
<p>Al agregar una nueva definición, se muestran estos campos:</p>
<blockquote>
<div><dl class="docutils">
<dt>Nombre</dt>
<dd><p class="first last">Nombre del CSV de llamadas programado</p>
</dd>
<dt>Correo electrónico</dt>
<dd><p class="first last">Enviar el CSV de llamadas generado por correo electrónico. Vacío si no se desea correo automático.</p>
</dd>
<dt>Tipo de cliente</dt>
<dd><p class="first last">Seleccionar <em>Todos</em> generará un CSV que contiene llamadas de todos los clientes. Seleccionar un tipo de cliente permitirá seleccionar un cliente específico de ese tipo.</p>
</dd>
<dt>Plantilla de notificación</dt>
<dd><p class="first last">Utilizado en notificaciones por correo electrónico para programadores que contienen llamadas de todos los clientes. En programadores específicos de clientes, se utilizará la plantilla de notificación asignada al cliente específico.</p>
</dd>
<dt>Frecuencia/Unidad</dt>
<dd><p class="first last">Define la frecuencia (una vez al mes, cada 7 días, etc.) de la tarea programada</p>
</dd>
<dt>Dirección</dt>
<dd><p class="first last">Define qué llamadas deben incluirse según su dirección (entrante, saliente, ambas).</p>
</dd>
<dt>Carrier</dt>
<dd><p class="first last">Solo para informes de <em>Dirección: saliente</em>, permite filtrar llamadas de un carrier específico.</p>
</dd>
<dt>Cliente</dt>
<dd><p class="first last">Solo para <em>Tipo de cliente</em> diferente de <em>Todos</em>, permite seleccionar un cliente específico del tipo elegido.</p>
</dd>
<dt>DDI</dt>
<dd><p class="first last">Lista todos los DDI del cliente elegido para obtener solo llamadas desde/hacia ese DDI específico.</p>
</dd>
<dt>Tipo de punto final</dt>
<dd><p class="first last">Permite seleccionar un tipo de punto final específico del cliente elegido. Dependiendo del tipo de cliente, se listarán diferentes valores.</p>
</dd>
<dt>Dispositivo residencial</dt>
<dd><p class="first last">Solo para <em>Tipo de cliente: residencial</em> y <em>Tipo de punto final: dispositivo residencial</em>, permite seleccionar un dispositivo residencial específico del cliente elegido.</p>
</dd>
<dt>Cuenta minorista</dt>
<dd><p class="first last">Solo para <em>Tipo de cliente: minorista</em>, permite seleccionar una cuenta minorista específica del cliente elegido.</p>
</dd>
<dt>Usuario</dt>
<dd><p class="first last">Solo para <em>Tipo de cliente: vpbx</em> y <em>Tipo de punto final: usuario</em>, permite seleccionar un usuario específico del cliente elegido.</p>
</dd>
<dt>Fax</dt>
<dd><p class="first last">Solo para <em>Tipo de cliente: vpbx/residencial</em> y <em>Tipo de punto final: fax</em>, permite seleccionar un fax específico del cliente elegido.</p>
</dd>
<dt>Amigo</dt>
<dd><p class="first last">Solo para <em>Tipo de cliente: vpbx</em> y <em>Tipo de punto final: amigo</em>, permite seleccionar un amigo específico del cliente elegido.</p>
</dd>
</dl>
</div></blockquote>
<p>Una vez creado, algunos campos y subsecciones nuevos son accesibles:</p>
<blockquote>
<div><dl class="docutils">
<dt>Próxima ejecución</dt>
<dd><p class="first last">Muestra la fecha de la próxima ejecución</p>
</dd>
<dt>Última ejecución</dt>
<dd><p class="first last">Muestra la última ejecución y su resultado.</p>
</dd>
</dl>
</div></blockquote>
<div class="admonition tip">
<p class="first admonition-title">Truco</p>
<p class="last">Modificar el valor de <em>Próxima ejecución</em> permite forzar ejecuciones específicas. Por ejemplo, configurar <em>Próxima ejecución</em> al primer día del mes actual creará nuevamente el informe CSV del mes pasado (para un programador mensual).</p>
</div>
<p>Los CSV generados de cada programador se pueden acceder en la subsección <strong>Lista de informes CSV de llamadas</strong>.</p>
<div class="section" id="csv-fields">
<h2>Campos CSV</h2>
<p>Estos son los campos de los archivos CSV generados:</p>
<blockquote>
<div><dl class="docutils">
<dt>callid</dt>
<dd><p class="first last">Call-ID del diálogo SIP</p>
</dd>
<dt>Hora de inicio</dt>
<dd><p class="first last">Hora y fecha del establecimiento de la llamada</p>
</dd>
<dt>duración</dt>
<dd><p class="first last">Duración de la llamada en segundos</p>
</dd>
<dt>llamante</dt>
<dd><p class="first last">Número del llamante en formato E.164 (con &#8216;+&#8217;)</p>
</dd>
<dt>llamado</dt>
<dd><p class="first last">Número del llamado en formato E.164 (con &#8216;+&#8217;)</p>
</dd>
<dt>costo</dt>
<dd><p class="first last">Costo calculado para la llamada dada</p>
</dd>
<dt>precio</dt>
<dd><p class="first last">Precio calculado para la llamada dada</p>
</dd>
<dt>tipo de punto final</dt>
<dd><p class="first last">Valores posibles: RetailAccount, ResidentialDevice, User, Fax, Friend.</p>
</dd>
<dt>ID del punto final</dt>
<dd><p class="first last">ID interno del punto final específico (solo cuando <em>endpointType</em> no está vacío).</p>
</dd>
<dt>Nombre del punto final</dt>
<dd><p class="first last">Extensión de usuario, nombre del amigo, nombre del fax, nombre de la cuenta minorista o nombre del dispositivo residencial (solo cuando <em>endpointId</em> no está vacío).</p>
</dd>
<dt>dirección</dt>
<dd><p class="first last">Valores posibles: entrante, saliente.</p>
</dd>
<dt>ID de la empresa</dt>
<dd><p class="first last">ID del cliente</p>
</dd>
<dt>ID del carrier</dt>
<dd><p class="first last">Solo para llamadas salientes, ID interno del carrier utilizado</p>
</dd>
<dt>ID del proveedor de DDI</dt>
<dd><p class="first last">Solo para llamadas entrantes, ID interno del proveedor de DDI utilizado</p>
</dd>
<dt>ID del DDI</dt>
<dd><p class="first last">DDI del cliente al que se asignará la llamada (llamado para llamadas entrantes, llamante para llamadas salientes). Vacío para clientes mayoristas.</p>
</dd>
</dl>
</div></blockquote>
</div>
<div class="section" id="ddi-provider-detection">
<h2>Detección del proveedor de DDI</h2>
<p>La detección del proveedor de DDI merece una explicación más profunda ya que no es tan inequívoca como el Carrier (el carrier es el elegido por la lógica de enrutamiento, no hay duda aquí).</p>
<p>La lógica de detección del proveedor de DDI está directamente relacionada con la lógica de detección de DDI subyacente.</p>
<p>Cuando IvozProvider recibe una INVITACIÓN a KamTrunks de una entidad externa:</p>
<ol class="arabic">
<li><p class="first">La IP de origen se compara con todas las direcciones de los proveedores de DDI (de todas las marcas).</p>
<blockquote>
<div><ul class="simple">
<li><p class="first">Si ninguno coincide, la llamada es rechazada.</p>
</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">El DDI se transforma en un bucle utilizando las reglas de transformación de los proveedores de DDI coincidentes (el id más bajo, el primero).</p>
</li>
<li><p class="first">Tan pronto como el DDI transformado coincide con un DDI (en E.164) dentro de la misma marca, el bucle termina y la llamada es aceptada.</p>
<blockquote>
<div><ul class="simple">
<li><p class="first">Si el bucle termina sin ninguna coincidencia, la llamada es rechazada.</p>
</li>
</ul>
</div></blockquote>
</li>
</ol>
<p>El proveedor de DDI que permitió esa coincidencia se guarda como proveedor de DDI para esa llamada entrante, excepto:</p>
<ul class="simple">
<li><p class="first">El DDI coincidente está vinculado a otro proveedor de DDI que también coincide con la dirección IP de origen. Si esto sucede, el proveedor de DDI vinculado se guarda en su lugar.</p>
</li>
</ul>
</div>
<div class="section" id="using-csv-scheduler-as-a-one-shot-csv-generator">
<h2>Usar el programador de CSV como un generador de CSV de una sola vez</h2>
<p>La sección <em>Llamadas externas</em> puede filtrar la lista y exportar las filas resultantes a CSV, pero los criterios de filtrado son mucho más poderosos en la sección <em>Programadores de CSV de llamadas</em>.</p>
<p>Es por eso que <strong>podría ser útil usar esta sección incluso si no estamos interesados en programar ningún CSV recurrente</strong>.</p>
<div class="admonition note">
<p class="first admonition-title">Nota</p>
<p class="last">Programar un CSV para generar solo un CSV podría ser útil ya que <em>Programadores de CSV de llamadas</em> tienen más criterios de filtrado que la sección <em>Llamadas externas</em>.</p>
</div>
<p>Imagina que necesitas:</p>
<ul class="simple">
<li><p class="first">Fecha de inicio: 2020/06/02 (incluida)</p>
</li>
<li><p class="first">Fecha de finalización: 2020/06/14 (incluida)</p>
</li>
<li><p class="first">Cliente: XXX (vpbx)</p>
</li>
<li><p class="first">Llamadas entrantes al DDI YYY respondidas por el usuario ZZZ</p>
</li>
</ul>
<p>Para lograr un CSV así usando la sección de programadores, <strong>crearíamos un programador</strong> con estos datos:</p>
<ul class="simple">
<li><p class="first">Tipo de cliente: vpbx</p>
</li>
<li><p class="first">Cliente: XXX</p>
</li>
<li>DDI: YYY</li>
<li><p class="first">Tipo de punto final: usuario</p>
</li>
<li><p class="first">Usuario: ZZZ</p>
</li>
<li><p class="first">Dirección: entrante.</p>
</li>
<li><p class="first">Unidad: días.</p>
</li>
<li><p class="first">Frecuencia: 13</p>
</li>
</ul>
<div class="admonition tip">
<p class="first admonition-title">Truco</p>
<p class="last">Asegúrate de configurar <em>Unidad</em> en días y <em>Frecuencia</em> en la cantidad de días deseados en el CSV resultante. En el ejemplo, del 2 de junio al 14, ambos incluidos, tenemos 13 días.</p>
</div>
<p>Una vez generado, <strong>editaríamos la hora de la próxima ejecución</strong> de la fecha de mañana a 2020/06/15, dejando la hora sin cambios.</p>
<div class="admonition tip">
<p class="first admonition-title">Truco</p>
<p class="last">Asegúrate de modificar <em>Próxima ejecución</em> al primer día no deseado en el CSV resultante.</p>
</div>
<p>Luego <strong>esperaremos unos minutos</strong> hasta que el programador genere nuestro CSV, <strong>lo descargaremos</strong> y <strong>eliminaremos la fila para evitar la generación recurrente de CSV</strong>.</p>
</div>
</div>


          </div>
      </div>
      <div class="clearer"></div>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2016-2019, Irontec.
      Creado con <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.9.
    </div>
  </body>
</html>